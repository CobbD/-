<!DOCTYPE html>
<html>
<head>
<!-- 2016-03-28 一 12:10 -->
<meta  charset="utf-8">
<meta  name="viewport" content="width=device-width, initial-scale=1">
<title>datetime模块</title>
<meta  name="generator" content="Org-mode">
<meta  name="author" content="万泽(德山书生)">
<meta  name="description" content="制作者邮箱：a358003542@gmail.com"
>
<style type="text/css">
body {

}
@media (min-width: 768px) {
  body {
    width: 732px;
    padding-right: 20px;
    padding-left: 20px;
    margin-right: auto;
    margin-left: auto;
  }
}
@media (min-width: 992px) {
  body {
    width: 880px;
    padding-right: 100px;
    padding-left: 100px;
    margin-right: auto;
    margin-left: auto;
  }
}
@media (min-width: 1200px) {
  body {
    width: 750px;
    padding-right: 200px;
    padding-left: 200px;
    margin-right: auto;
    margin-left: auto;
  }
}

.title {
    display: block;
    text-align: center;
    padding: 10px;
}

.center-block {
    display: block;
    margin-left: auto;
    margin-right: auto;
}

.underline{
    text-decoration: underline;
}
   #content {
    display: block;
    margin-left: auto;
    margin-right: auto;
}

code {
    padding: 2px 4px;
    color: #c7254e;
    background-color: #f9f2f4;
    border-radius: 4px;
}

pre {
    max-width: 100%;
    display: block;
    padding: 9.5px;
    margin: 0 0 10px;
    font-size: 13px;
    line-height: 1.42857143;
    color: #333;
    background-color: #f5f5f5;
    border: 1px solid #ccc;
    border-radius: 4px;
    overflow : auto;
}


blockquote {
    padding: 10px 20px;
    margin: 0 0 20px;
    font-size: 17.5px;
    border-left: 5px solid #eee;
}


p{
    text-indent:2em;
    line-height:150%;
}

li, dt{
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}

video{
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;
}

figure p{
    text-indent:0em;
}
img{
    max-width: 100%;
}

embed{
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;
}

figure{
    text-align: center;
}

/*  class  */
.FRAMED{
    max-width:100%;
    border:1px solid ;
    padding: 1em;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

.NOTECARD{
    width: 30%;
    position:relative;
    right: -30%;
    padding: 1em;
    margin:0 auto;
    border: solid 1px;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

/*
table
*/
table {
    border-collapse: collapse;
    border-spacing: 0;
    margin: 16px 0;
    empty-cells: show;
    border: 1px solid #ccc;
    width: 100%;
    display: table;
}

table tr {
    border-bottom: 1px solid #ddd;
}
table th,table td{
    padding:8px;
}

table tr:nth-child(even) {
    background-color: #f1f1f1;
}
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #8f5902; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #ef2929 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #204a87; font-weight: bold } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #ce5c00; font-weight: bold } /* Operator */
.highlight .x { color: #000000 } /* Other */
.highlight .p { color: #000000; font-weight: bold } /* Punctuation */
.highlight .ch { color: #8f5902; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #8f5902; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #8f5902; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #8f5902; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #8f5902; font-style: italic } /* Comment.Single */
.highlight .cs { color: #8f5902; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #ef2929 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #a40000; font-weight: bold } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #204a87; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #204a87; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #204a87; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #204a87; font-weight: bold } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #0000cf; font-weight: bold } /* Literal.Number */
.highlight .s { color: #4e9a06 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #204a87 } /* Name.Builtin */
.highlight .nc { color: #000000 } /* Name.Class */
.highlight .no { color: #000000 } /* Name.Constant */
.highlight .nd { color: #5c35cc; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #ce5c00 } /* Name.Entity */
.highlight .ne { color: #cc0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #000000 } /* Name.Function */
.highlight .nl { color: #f57900 } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #204a87; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #000000 } /* Name.Variable */
.highlight .ow { color: #204a87; font-weight: bold } /* Operator.Word */
.highlight .w { color: #f8f8f8; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #0000cf; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000cf; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000cf; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000cf; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000cf; font-weight: bold } /* Literal.Number.Oct */
.highlight .sb { color: #4e9a06 } /* Literal.String.Backtick */
.highlight .sc { color: #4e9a06 } /* Literal.String.Char */
.highlight .sd { color: #8f5902; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4e9a06 } /* Literal.String.Double */
.highlight .se { color: #4e9a06 } /* Literal.String.Escape */
.highlight .sh { color: #4e9a06 } /* Literal.String.Heredoc */
.highlight .si { color: #4e9a06 } /* Literal.String.Interpol */
.highlight .sx { color: #4e9a06 } /* Literal.String.Other */
.highlight .sr { color: #4e9a06 } /* Literal.String.Regex */
.highlight .s1 { color: #4e9a06 } /* Literal.String.Single */
.highlight .ss { color: #4e9a06 } /* Literal.String.Symbol */
.highlight .bp { color: #3465a4 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #000000 } /* Name.Variable.Class */
.highlight .vg { color: #000000 } /* Name.Variable.Global */
.highlight .vi { color: #000000 } /* Name.Variable.Instance */
.highlight .il { color: #0000cf; font-weight: bold } /* Literal.Number.Integer.Long */
</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">datetime模块</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. 简介</a></li>
<li><a href="#orgheadline2">2. timedelta对象</a></li>
<li><a href="#orgheadline10">3. datetime对象</a>
<ul>
<li><a href="#orgheadline6">3.1. now和utcnow类方法</a>
<ul>
<li><a href="#orgheadline3">3.1.1. 查看pytz的所有时区</a></li>
<li><a href="#orgheadline4">3.1.2. 具体给now方法指定一个时区</a></li>
<li><a href="#orgheadline5">3.1.3. now方法和utcnow方法区别</a></li>
</ul>
</li>
<li><a href="#orgheadline7">3.2. 可以调用的属性</a></li>
<li><a href="#orgheadline8">3.3. strftime方法</a></li>
<li><a href="#orgheadline9">3.4. 支持的时间间隔运算</a></li>
</ul>
</li>
</ul>
</div>
</nav>


<div class="outline-2">
<h2 id="orgheadline1">简介</h2>
<div class="outline-text-2" id="text-1">
<p>
简单的日期时间操作用time模块里面的一些函数即可，datetime模块是用类的方式来处理的，适合大量处理日期时间的任务。然后值得一提的是mongodb的python接口pymongo里面，日期时间是可以直接输入datetime对象的，这很是方便。
</p>

<p>
下面简要介绍之，更多内容请参看 <a href="https://docs.python.org/3.4/library/datetime.html">官方文档</a> 。
</p>
</div>
</div>


<div class="outline-2">
<h2 id="orgheadline2">timedelta对象</h2>
<div class="outline-text-2" id="text-2">
<p>
通过timedelta函数返回一个timedelta对象，也就是一个表示时间间隔的对象。函数参数情况如下所示:
</p>

<pre>
class datetime.timedelta([days[, seconds[, microseconds[, milliseconds[, minutes[, hours[, weeks]]]]]]])
</pre>

<p>
其没有必填参数，简单控制的话第一个整数就是多少天的间隔的意思:
</p>

<pre>
datetime.timedelta(10)
</pre>

<p>
两个时间间隔对象可以彼此之间相加或相减，返回的仍是一个时间间隔对象。而更方便的是一个datetime对象如果减去一个时间间隔对象，那么返回的对应减去之后的datetime对象，然后两个datetime对象如果相减返回的是一个时间间隔对象。这很是方便。
</p>
</div>
</div>




<div class="outline-2">
<h2 id="orgheadline10">datetime对象</h2>
<div class="outline-text-2" id="text-3">
<p>
通过datetime函数可以创建一个datetime对象:
</p>
<pre>
class datetime.datetime(year, month, day[, hour[, minute[, second[, microsecond[, tzinfo]]]]])
</pre>

<p>
其中year，month和day是必填参数。下面是一个简单的例子:
</p>

<pre>
&gt;&gt;&gt; db_t = {
...  "date": datetime.datetime(1777,07,07)
... }
&gt;&gt;&gt; db_t
{'date': datetime.datetime(1777, 7, 7, 0, 0)}
</pre>

<p>
其通过pymongo存入mongodb之后是这样的形式:
</p>
<pre>
ISODate("1777-07-07T00:00:00.000Z")
</pre>
</div>

<div class="outline-3">
<h3 id="orgheadline6">now和utcnow类方法</h3>
<div class="outline-text-3" id="text-3-1">
<p>
datetime对象有 <code>now</code> 和 <code>utcnow</code> 这两个类方法（classmethod）来返回当前日期时间的datetime对象。utcnow不可以接受参数，now方法可以接受一个tz指定时区的参数，我们可以通过pytz模块（注意，这是一个第三方模块，可以通过pip安装之。）来具体指明某个时区。
</p>
</div>

<div class="outline-4">
<h4 id="orgheadline3">查看pytz的所有时区</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
参看 <a href="http://stackoverflow.com/questions/13866926/python-pytz-list-of-timezones">这个网页</a> 。
</p>
<pre>
&gt;&gt;&gt; pytz.all_timezones
['Africa/Abidjan', 'Africa/Accra', 'Africa/Addis_Ababa', 'Africa/Algiers', ......
</pre>
</div>
</div>

<div class="outline-4">
<h4 id="orgheadline4">具体给now方法指定一个时区</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
参看 <a href="http://stackoverflow.com/questions/2331592/datetime-datetime-utcnow-why-no-tzinfo">这个网页</a> 。
</p>

<pre>
import pytz
datetime.datetime.now(tz = pytz.timezone("Asia/Hong_Kong"))
</pre>
</div>
</div>

<div class="outline-4">
<h4 id="orgheadline5">now方法和utcnow方法区别</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
我们看下面这个例子:
</p>
<pre>
&gt;&gt;&gt; datetime.now(tz = pytz.timezone("UTC")),datetime.utcnow()
(datetime.datetime(2015, 7, 11, 9, 25, 20, 266863, tzinfo=&lt;UTC&gt;), datetime.datetime(2015, 7, 11, 9, 25, 20, 266888))
</pre>

<p>
如果我们给now方法指定默认的时区是"UTC"，那么我们看到其返回的datetime对象和utcnow返回的datetime对象基本上没什么区别，后面的微秒（ \(10^{-6}\) 秒）有点区别完全可以理解。然后我们再看now方法如果不加任何参数会如何:
</p>

<pre>
&gt;&gt;&gt; now
datetime.datetime(2015, 7, 11, 16, 34, 43, 144018)
&gt;&gt;&gt; utcnow
datetime.datetime(2015, 7, 11, 8, 34, 56, 319108)
</pre>

<p>
这里now显示的时间和本地的时间是一致的，说明now默认的时区是本地的时区参数。谈到这里大家应该就明白了，如果是后台数据库有日期时间输入需求，为了保持时间戳的一致性，推荐都使用utcnow方法来生成时间戳，也就是实际上都以UTC格林威治时区为准。如果到前端需要显示给用户具体的日期时间了，如果要引用前端数据库的日期时间，才需要引入时区的考虑进行必要的转换。然后如果前端需要用python生成实时的时间，那么就用now方法再引入pytz的时区控制。
</p>
</div>
</div>
</div>

<div class="outline-3">
<h3 id="orgheadline7">可以调用的属性</h3>
<div class="outline-text-3" id="text-3-2">
<pre>
&gt;&gt;&gt; from datetime import datetime
&gt;&gt;&gt; d = datetime.now()
&gt;&gt;&gt; d.year
2015
&gt;&gt;&gt; d.month
11
&gt;&gt;&gt; d.day
3
&gt;&gt;&gt; d.hour
18
&gt;&gt;&gt; d.minute
42
&gt;&gt;&gt; d.second
57
&gt;&gt;&gt; d.tzinfo
&gt;&gt;&gt; d
datetime.datetime(2015, 11, 3, 18, 42, 57, 919613)
</pre>

<p>
具体如上所示，含义一清二楚:
</p>
<dl class="org-dl">
<dt>year</dt><dd>年</dd>
<dt>month</dt><dd>月</dd>
<dt>day</dt><dd>日</dd>
<dt>hour</dt><dd>时</dd>
<dt>minute</dt><dd>分</dd>
<dt>second</dt><dd>秒</dd>
<dt>microsecond</dt><dd>微秒</dd>
</dl>
</div>
</div>

<div class="outline-3">
<h3 id="orgheadline8">strftime方法</h3>
<div class="outline-text-3" id="text-3-3">
<p>
datetime对象可以如下调用 <code>strftiime</code> 方法或者 <code>__format__</code> 方法来得到一个好看的你想要的日期时间字符串格式:
</p>
<pre>
&gt;&gt;&gt; from datetime import datetime
&gt;&gt;&gt; d = datetime.now()
&gt;&gt;&gt; d.strftime('%T')
'18:52:39'
&gt;&gt;&gt; d.__format__('%F')
'2015-11-03'
</pre>

<p>
这里的格式符号python官方文档有所述及，而更实际上是和linux系统下的 <code>date</code> 命令的格式符一致的，读者可以用 <code>date --help</code> 来看一下，就可以看到如下信息:
</p>

<pre>
%%	一个文字的 %
%a	当前locale 的星期名缩写(例如： 日，代表星期日)
%A	当前locale 的星期名全称 (如：星期日)
%b	当前locale 的月名缩写 (如：一，代表一月)
%B	当前locale 的月名全称 (如：一月)
%c	当前locale 的日期和时间 (如：2005年3月3日 星期四 23:05:25)
%C	世纪；比如 %Y，通常为省略当前年份的后两位数字(例如：20)
%d	按月计的日期(例如：01)
%D	按月计的日期；等于%m/%d/%y
%e	按月计的日期，添加空格，等于%_d
%F	完整日期格式，等价于 %Y-%m-%d
%g	ISO-8601 格式年份的最后两位 (参见%G)
%G	ISO-8601 格式年份 (参见%V)，一般只和 %V 结合使用
%h	等于%b
%H	小时(00-23)
%I	小时(00-12)
%j	按年计的日期(001-366)
%k   hour, space padded ( 0..23); same as %_H
%l   hour, space padded ( 1..12); same as %_I
%m   month (01..12)
%M   minute (00..59)
%n	换行
%N	纳秒(000000000-999999999)
%p	当前locale 下的"上午"或者"下午"，未知时输出为空
%P	与%p 类似，但是输出小写字母
%r	当前locale 下的 12 小时时钟时间 (如：11:11:04 下午)
%R	24 小时时间的时和分，等价于 %H:%M
%s	自UTC 时间 1970-01-01 00:00:00 以来所经过的秒数
%S	秒(00-60)
%t	输出制表符 Tab
%T	时间，等于%H:%M:%S
%u	星期，1 代表星期一
%U	一年中的第几周，以周日为每星期第一天(00-53)
%V	ISO-8601 格式规范下的一年中第几周，以周一为每星期第一天(01-53)
%w	一星期中的第几日(0-6)，0 代表周一
%W	一年中的第几周，以周一为每星期第一天(00-53)
%x	当前locale 下的日期描述 (如：12/31/99)
%X	当前locale 下的时间描述 (如：23:13:48)
%y	年份最后两位数位 (00-99)
%Y	年份
%z +hhmm		数字时区(例如，-0400)
%:z +hh:mm		数字时区(例如，-04:00)
%::z +hh:mm:ss	数字时区(例如，-04:00:00)
%:::z			数字时区带有必要的精度 (例如，-04，+05:30)
%Z			按字母表排序的时区缩写 (例如，EDT)
</pre>

<p>
其中的 <code>%F</code> 和 <code>%T</code> 在python官方文档中并无说明，可见其内部API是和这个 <code>date</code> 命令一致的。
</p>
</div>
</div>



<div class="outline-3">
<h3 id="orgheadline9">支持的时间间隔运算</h3>
<div class="outline-text-3" id="text-3-4">
<p>
前面提到了一个datetime对象减去一个timedelta对象返回一个datetime对象，然后一个datetime对象减去一个datetime对象返回一个时间间隔对象。比如此时之前一年的时间可以这样表达 <code>datetime.datetime.utcnow() - datetime.timedelta(365)</code> 。然后此时和爱因斯坦的生日时间间隔可以这样表达: <code>datetime.datetime.utcnow() - datetime.datetime(1879,03,14)</code> 。
</p>

<p>
然后我们可以利用这个时间间隔来进行一些操作和判断。
</p>
<pre>
&gt;&gt;&gt; delta = datetime.datetime.utcnow() - datetime.datetime(1879,03,14)
&gt;&gt;&gt; delta
datetime.timedelta(49792, 35970, 903285)
&gt;&gt;&gt; delta &gt; datetime.timedelta(120*365)
True
&gt;&gt;&gt; delta.days // 365
136
</pre>
</div>
</div>
</div>
</div>
</body>
</html>
